# üç¶ ICE CREAM COMPANY ‚Äì SQL DATASET

```sql
/* ======================================
   DATABASE
====================================== */
DROP DATABASE IF EXISTS icecream_company;
CREATE DATABASE icecream_company;
USE icecream_company;

/* ======================================
   TABLE 1: FLAVORS
====================================== */
CREATE TABLE flavors (
    flavor_id INT PRIMARY KEY,
    flavor_name VARCHAR(40),
    category VARCHAR(30)
);

INSERT INTO flavors VALUES
(1, 'Vanilla', 'Classic'),
(2, 'Chocolate', 'Classic'),
(3, 'Strawberry', 'Classic'),
(4, 'Mango', 'Fruit'),
(5, 'Butterscotch', 'Premium'),
(6, 'Cookies & Cream', 'Premium'),
(7, 'Pistachio', 'Dry Fruit');

/* ======================================
   TABLE 2: OUTLETS
====================================== */
CREATE TABLE outlets (
    outlet_id INT PRIMARY KEY,
    outlet_name VARCHAR(50),
    city VARCHAR(40)
);

INSERT INTO outlets VALUES
(1, 'Creamy Delights', 'Indore'),
(2, 'Frozen Treats', 'Bhopal'),
(3, 'Ice Magic', 'Mumbai'),
(4, 'Chill Zone', 'Delhi');

/* ======================================
   TABLE 3: EMPLOYEES (SELF JOIN)
====================================== */
CREATE TABLE employees (
    emp_id INT PRIMARY KEY,
    emp_name VARCHAR(50),
    role VARCHAR(30),
    manager_id INT,
    outlet_id INT,
    FOREIGN KEY (manager_id) REFERENCES employees(emp_id),
    FOREIGN KEY (outlet_id) REFERENCES outlets(outlet_id)
);

INSERT INTO employees VALUES
(1, 'Rohit', 'Manager', NULL, 1),
(2, 'Neha', 'Manager', NULL, 2),
(3, 'Amit', 'Manager', NULL, 3),
(4, 'Pooja', 'Manager', NULL, 4),

(5, 'Rahul', 'Sales Executive', 1, 1),
(6, 'Simran', 'Sales Executive', 1, 1),
(7, 'Karan', 'Sales Executive', 2, 2),
(8, 'Meena', 'Sales Executive', 2, 2),
(9, 'Arjun', 'Sales Executive', 3, 3),
(10, 'Isha', 'Sales Executive', 4, 4);

/* ======================================
   TABLE 4: SALES (MONTH AS CATEGORICAL)
====================================== */
CREATE TABLE sales (
    sale_id INT PRIMARY KEY,
    outlet_id INT,
    flavor_id INT,
    sale_month VARCHAR(15),   -- categorical month
    year INT,
    quantity_sold INT,
    revenue INT,
    FOREIGN KEY (outlet_id) REFERENCES outlets(outlet_id),
    FOREIGN KEY (flavor_id) REFERENCES flavors(flavor_id)
);

INSERT INTO sales VALUES
(1, 1, 1, 'January', 2025, 320, 64000),
(2, 1, 2, 'January', 2025, 280, 70000),
(3, 1, 4, 'February', 2025, 450, 90000),
(4, 1, 5, 'March', 2025, 200, 60000),

(5, 2, 1, 'January', 2025, 300, 60000),
(6, 2, 3, 'February', 2025, 260, 52000),
(7, 2, 4, 'March', 2025, 500, 100000),

(8, 3, 2, 'January', 2025, 350, 87500),
(9, 3, 6, 'February', 2025, 220, 77000),
(10, 3, 7, 'March', 2025, 180, 72000),

(11, 4, 1, 'January', 2025, 290, 58000),
(12, 4, 4, 'February', 2025, 480, 96000),
(13, 4, 6, 'March', 2025, 210, 73500);
```

---

# PRACTICE QUESTIONS

## EASY

1. Show all ice cream flavors.
2. List all outlets and their cities.
3. Display employee name and role.
4. Show all sales done in **January**.
5. List distinct sale months available.
6. Show total quantity sold for each flavor.
7. Display sales where revenue is greater than 70,000.
8. List employees working in the **Indore** outlet.
9. Show flavor name along with its category.
10. Display outlet name and total revenue generated.

---

## MEDIUM

11. Show total revenue generated by each outlet.
12. Find total quantity sold per month.
13. Display the **top-selling flavor** based on quantity.
14. List managers and the employees reporting to them (self join).
15. Show outlet-wise monthly revenue.
16. Find which city sold the highest quantity of ice cream.
17. Display average revenue per sale for each outlet.
18. Show flavors that were sold in **all three months**.
19. Find employees who work under the same manager.
20. Show month-wise revenue trend (ordered Jan ‚Üí Mar).

---

## HARD

21. Find the outlet whose **March revenue** is higher than its **January revenue**.
22. Display the flavor that generated the **maximum revenue overall**.
23. Find the manager whose outlet has the **highest total sales**.

---